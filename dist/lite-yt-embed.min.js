"use strict";class LiteYTEmbed extends HTMLElement{constructor(){super(...arguments),this.videoId="",this.playLabel="",this.size="",this.jpg="",this.webp=""}static checkWebpSupport(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}static warmConnections(){LiteYTEmbed.preconnected||(LiteYTEmbed.addPrefetch("preconnect","https://www.youtube-nocookie.com"),LiteYTEmbed.addPrefetch("preconnect","https://www.google.com"),LiteYTEmbed.addPrefetch("preconnect","https://googleads.g.doubleclick.net"),LiteYTEmbed.addPrefetch("preconnect","https://static.doubleclick.net"),LiteYTEmbed.preconnected=!0)}static addPrefetch(t,e){var i=document.createElement("link");i.rel=t,i.href=e,document.head.append(i)}connectedCallback(){var e;window.LiteYTEmbedConfig=window.LiteYTEmbedConfig||{},this.videoId=this.getAttribute("videoid")||"";let t=this.querySelector(".lyt-playbtn");if(this.playLabel=(null==(e=null===t||void 0===t?void 0:t.textContent)?void 0:e.trim())||this.getAttribute("playlabel")||window.LiteYTEmbedConfig.playLabel||"Play","yes"===(this.getAttribute("showtitle")||window.LiteYTEmbedConfig.showTitle||"no")){let t=this.querySelector(".lyt-title");t||((t=document.createElement("div")).className="lyt-title",this.append(t)),t.textContent||((e=document.createElement("span")).textContent=this.playLabel,t.append(e))}this.addPoster(),t||((t=document.createElement("button")).type="button",t.className="lyt-playbtn",this.append(t)),t.textContent||((e=document.createElement("span")).className="lyt-visually-hidden",e.textContent=this.playLabel,t.append(e)),t.removeAttribute("href"),t.removeAttribute("target"),this.addEventListener("pointerover",LiteYTEmbed.warmConnections,{once:!0}),this.addEventListener("click",this.addIframe),void 0===LiteYTEmbed.usesApi&&(LiteYTEmbed.usesApi=window.LiteYTEmbedConfig.forceApi||navigator.vendor.includes("Apple")||navigator.userAgent.includes("Mobi"))}addPoster(){var t,e;this.querySelector(".lyt-preview-container")||(this.size=this.getAttribute("size")||(null==(t=window.LiteYTEmbedConfig)?void 0:t.size)||"hq",["mq","hq","sd","maxres"].includes(this.size)&&(this.jpg=this.getAttribute("jpg")||"",this.webp=this.getAttribute("webp")||(null==(t=window.LiteYTEmbedConfig)?void 0:t.webp)||"yes",void 0===LiteYTEmbed.supportsWebp&&(LiteYTEmbed.supportsWebp=LiteYTEmbed.checkWebpSupport()),LiteYTEmbed.supportsWebp||(this.webp="no"),(t=document.createElement("picture")).className="lyt-poster-container","no"!==this.webp&&((e=document.createElement("source")).setAttribute("type","image/webp"),e.setAttribute("srcset","yes"===this.webp?`https://i.ytimg.com/vi_webp/${this.videoId}/${this.size}default.webp`:this.webp),t.appendChild(e)),this.poster=document.createElement("img"),this.poster.setAttribute("decoding","async"),this.poster.setAttribute("loading","lazy"),this.setPosterDimensions(),this.poster.setAttribute("src",this.jpg||`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`),this.poster.setAttribute("alt",this.playLabel),this.poster.setAttribute("title",this.playLabel),this.poster.className="lyt-poster",null!=(e=window.LiteYTEmbedConfig)&&e.useFallback&&(this.classList.add("lyt-poster-hidden"),this.onPosterLoad=this.onPosterLoad.bind(this),this.onPosterError=this.onPosterError.bind(this),this.poster.complete&&this.onPosterLoad(),this.poster.addEventListener("load",this.onPosterLoad),this.poster.addEventListener("error",this.onPosterError)),t.appendChild(this.poster),this.insertBefore(t,this.firstChild)))}setPosterDimensions(){var t;let e,i;switch(this.size){case"mq":e=320,i=180;break;case"hq":e=480,i=360;break;case"sd":e=640,i=480;break;default:e=1280,i=720}null!=(t=this.poster)&&t.setAttribute("width",e.toString()),null!=(t=this.poster)&&t.setAttribute("height",i.toString())}tryDownscalingSize(){switch(this.size){case"maxres":return this.size="sd",!0;case"sd":return this.size="hq",!0}return!1}onPosterLoad(){var t;((null==(t=this.poster)?void 0:t.naturalWidth)||0)<=120?this.onPosterError():this.classList.remove("lyt-poster-hidden")}onPosterError(){var t=this.querySelector("source");if(t)return"yes"!==this.webp?(this.webp="yes",void t.setAttribute("srcset",`https://i.ytimg.com/vi_webp/${this.videoId}/${this.size}default.webp`)):this.tryDownscalingSize()?(this.setPosterDimensions(),void t.setAttribute("srcset",`https://i.ytimg.com/vi_webp/${this.videoId}/${this.size}default.webp`)):(t.remove(),this.webp="no",void(null!=(t=this.poster)&&t.setAttribute("src",`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`)));this.jpg?(this.jpg="",null!=(t=this.poster)&&t.setAttribute("src",`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`)):this.tryDownscalingSize()&&(this.setPosterDimensions(),null!=(t=this.poster))&&t.setAttribute("src",`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`)}async addIframe(){if(!this.classList.contains("lyt-activated")){this.classList.add("lyt-activated");var t=new URLSearchParams(this.getAttribute("params")||(null==(t=window.LiteYTEmbedConfig)?void 0:t.params)||"");if(t.append("autoplay","1"),t.append("playsinline","1"),window.location.origin&&t.append("origin",window.location.origin),LiteYTEmbed.usesApi)return this.addYTPlayerIframe(t);var e=document.createElement("iframe");e.width="560",e.height="315",e.title=this.playLabel,e.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",e.allowFullscreen=!0,e.fetchPriority="high",e.src=`https://www.youtube-nocookie.com/embed/${this.videoId}?`+t.toString(),this.append(e),e.focus()}}async addYTPlayerIframe(t){await this.fetchYTPlayerApi();var e=document.createElement("div"),t=(this.append(e),Object.fromEntries(t.entries()));new YT.Player(e,{width:"100%",host:"https://www.youtube-nocookie.com",videoId:this.videoId,playerVars:t,events:{onReady:t=>{this.api=t.target,this.api.playVideo()}}})}fetchYTPlayerApi(){if(!window.YT)return new Promise((e,t)=>{var i=document.createElement("script");i.src="https://www.youtube.com/iframe_api",i.async=!0,i.onload=()=>{var t;null!=(t=window.YT)&&t.ready(e)},i.onerror=t,this.append(i)})}}LiteYTEmbed.preconnected=!1,customElements.define("lite-youtube",LiteYTEmbed);
//# sourceMappingURL=lite-yt-embed.min.js.map