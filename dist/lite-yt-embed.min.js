class LiteYTEmbed extends HTMLElement{connectedCallback(){window.LiteYTEmbedConfig=window.LiteYTEmbedConfig||{},this.videoId=this.getAttribute("videoid");let e=this.querySelector(".lty-playbtn");var t;this.playLabel=e&&e.textContent.trim()||this.getAttribute("playlabel")||"Play",this.addPreview(),e||((e=document.createElement("button")).type="button",e.classList.add("lty-playbtn"),this.append(e)),e.textContent||((t=document.createElement("span")).className="lyt-visually-hidden",t.textContent=this.playLabel,e.append(t)),e.removeAttribute("href"),this.addEventListener("pointerover",LiteYTEmbed.warmConnections,{once:!0}),this.addEventListener("click",this.addIframe),this.needsYTApiForAutoplay=window.LiteYTEmbedConfig.forceApi||navigator.vendor.includes("Apple")||navigator.userAgent.includes("Mobi")}static addPrefetch(e,t,i){var s=document.createElement("link");s.rel=e,s.href=t,i&&(s.as=i),document.head.append(s)}static warmConnections(){LiteYTEmbed.preconnected||(LiteYTEmbed.addPrefetch("preconnect","https://www.youtube-nocookie.com"),LiteYTEmbed.addPrefetch("preconnect","https://www.google.com"),LiteYTEmbed.addPrefetch("preconnect","https://googleads.g.doubleclick.net"),LiteYTEmbed.addPrefetch("preconnect","https://static.doubleclick.net"),LiteYTEmbed.preconnected=!0)}static checkWebPSupport(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0==e.toDataURL("image/webp").indexOf("data:image/webp")}fetchYTPlayerApi(){window.YT||window.YT&&window.YT.Player||(this.ytApiPromise=new Promise((t,e)=>{var i=document.createElement("script");i.src="https://www.youtube.com/iframe_api",i.async=!0,i.onload=e=>{YT.ready(t)},i.onerror=e,this.append(i)}))}addPreview(){var e;this.querySelector(".lty-preview-container")||(this.size=this.getAttribute("size")||window.LiteYTEmbedConfig.size||"hq",["mq","hq","sd","maxres"].includes(this.size)&&(this.jpg=this.getAttribute("jpg"),this.webp=this.getAttribute("webp")||window.LiteYTEmbedConfig.webp||"yes",void 0===LiteYTEmbed.supportsWebP&&(LiteYTEmbed.supportsWebP=LiteYTEmbed.checkWebPSupport()),LiteYTEmbed.supportsWebP||(this.webp="no"),this.previewContainer=document.createElement("picture"),this.previewContainer.className="lty-preview-container","no"!==this.webp&&((e=document.createElement("source")).setAttribute("type","image/webp"),e.setAttribute("srcset","yes"===this.webp?`https://i.ytimg.com/vi_webp/${this.videoId}/${this.size}default.webp`:this.webp),this.previewContainer.appendChild(e)),this.previewImage=document.createElement("img"),this.previewImage.setAttribute("decoding","async"),this.previewImage.setAttribute("loading","lazy"),this.setImageDimensions(),this.previewImage.setAttribute("src",this.jpg||`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`),this.previewImage.setAttribute("alt",this.playLabel),this.previewImage.setAttribute("title",this.playLabel),this.previewImage.className="lty-preview",window.LiteYTEmbedConfig.useFallback&&(this.onPosterLoad=this.onPosterLoad.bind(this),this.onPosterError=this.onPosterError.bind(this),this.previewImage.addEventListener("load",this.onPosterLoad),this.previewImage.addEventListener("error",this.onPosterError)),this.previewContainer.appendChild(this.previewImage),this.insertBefore(this.previewContainer,this.firstChild)))}onPosterLoad(){this.previewImage.naturalWidth<=120&&this.onPosterError()}onPosterError(){let e=this.querySelector("source");if(e)return"yes"!==this.webp?(this.webp="yes",void e.setAttribute("srcset",`https://i.ytimg.com/vi_webp/${this.videoId}/${this.size}default.webp`)):(this.tryDowngradingSize()||(e.remove(),e=null,this.webp="no"),this.setImageDimensions(),void(e?e.setAttribute("srcset",`https://i.ytimg.com/vi_webp/${this.videoId}/${this.size}default.webp`):this.previewImage.setAttribute("src",`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`)));this.jpg?(this.jpg=null,this.previewImage.setAttribute("src",`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`)):"hq"!==this.size&&(this.tryDowngradingSize(),this.previewImage.setAttribute("src",`https://i.ytimg.com/vi/${this.videoId}/${this.size}default.jpg`))}tryDowngradingSize(){switch(this.size){case"maxres":return this.size="sd",!0;case"sd":return this.size="hq",!0;default:return!1}}setImageDimensions(){let e,t;switch(this.size){case"mq":e=320,t=180;break;case"hq":e=480,t=360;break;case"sd":e=640,t=480;break;case"maxres":e=1280,t=720}this.previewImage.setAttribute("width",e),this.previewImage.setAttribute("height",t)}async addYTPlayerIframe(e){this.fetchYTPlayerApi(),await this.ytApiPromise;var t=document.createElement("div"),e=(this.append(t),Object.fromEntries(e.entries()));new YT.Player(t,{width:"100%",videoId:this.videoId,playerVars:e,events:{onReady:e=>{this.api=e.target,e.target.playVideo()}}})}async addIframe(){if(!this.classList.contains("lyt-activated")){this.classList.add("lyt-activated");var e=new URLSearchParams(this.getAttribute("params")||window.LiteYTEmbedConfig.params||"");if(e.append("autoplay","1"),e.append("playsinline","1"),this.needsYTApiForAutoplay)return this.addYTPlayerIframe(e);var t=document.createElement("iframe");t.width=560,t.height=315,t.title=this.playLabel,t.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,t.src=`https://www.youtube-nocookie.com/embed/${this.videoId}?`+e.toString(),this.append(t),t.focus()}}}customElements.define("lite-youtube",LiteYTEmbed);
//# sourceMappingURL=lite-yt-embed.min.js.map